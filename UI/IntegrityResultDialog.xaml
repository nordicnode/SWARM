<Window x:Class="Swarm.UI.IntegrityResultDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Integrity Check Results" 
        Height="450" Width="500"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    
    <Border Background="{StaticResource BackgroundDarkBrush}" 
            CornerRadius="12" 
            BorderBrush="#30FFFFFF" 
            BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="48"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- ========== TITLE BAR ========== -->
            <Border Grid.Row="0" Background="{StaticResource BackgroundMediumBrush}" 
                    CornerRadius="12,12,0,0" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="16,0">
                        <!-- Shield Icon -->
                        <Path Data="M12,1L3,5v6c0,5.55,3.84,10.74,9,12c5.16-1.26,9-6.45,9-12V5L12,1z M12,11.99h7c-0.53,4.12-3.28,7.79-7,8.94V12H5V6.3l7-3.11v8.8z"
                              Width="20" Height="20" 
                              Stretch="Uniform"
                              Fill="{StaticResource AccentPrimaryBrush}"
                              VerticalAlignment="Center"/>
                        <TextBlock Text="Integrity Check Results" FontWeight="Bold" FontSize="16" 
                                   Foreground="{StaticResource TextPrimaryBrush}" 
                                   VerticalAlignment="Center" Margin="12,0,0,0"/>
                    </StackPanel>

                    <!-- Close Button -->
                    <Button Content="âœ•" Width="40" Height="32" 
                            HorizontalAlignment="Right" Margin="0,0,8,0"
                            Foreground="#F85149"
                            Background="Transparent" BorderThickness="0"
                            Padding="0" Cursor="Hand"
                            Click="CloseButton_Click"/>
                </Grid>
            </Border>

            <!-- ========== CONTENT ========== -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="24,16">
                <StackPanel>
                    <!-- Summary Stats -->
                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Healthy Files -->
                        <Border Grid.Column="0" Background="#1043A047" CornerRadius="8" Padding="12" Margin="0,0,6,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock x:Name="HealthyCountText" Text="0" FontSize="28" FontWeight="Bold"
                                           Foreground="#43A047" HorizontalAlignment="Center"/>
                                <TextBlock Text="Healthy" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Corrupted Files -->
                        <Border Grid.Column="1" Background="#10F44336" CornerRadius="8" Padding="12" Margin="3,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock x:Name="CorruptedCountText" Text="0" FontSize="28" FontWeight="Bold"
                                           Foreground="#F44336" HorizontalAlignment="Center"/>
                                <TextBlock Text="Corrupted" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Missing Files -->
                        <Border Grid.Column="2" Background="#10FF9800" CornerRadius="8" Padding="12" Margin="6,0,0,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock x:Name="MissingCountText" Text="0" FontSize="28" FontWeight="Bold"
                                           Foreground="#FF9800" HorizontalAlignment="Center"/>
                                <TextBlock Text="Missing" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Duration -->
                    <TextBlock x:Name="DurationText" Text="Checked 0 files in 0.0s" 
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="12" Margin="0,0,0,16"/>

                    <!-- Status Message -->
                    <Border x:Name="StatusBorder" Background="#1043A047" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                        <StackPanel Orientation="Horizontal">
                            <Path x:Name="StatusIcon" 
                                  Data="M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"
                                  Width="20" Height="20" Stretch="Uniform"
                                  Fill="#43A047" VerticalAlignment="Center"/>
                            <TextBlock x:Name="StatusText" Text="All files are healthy!" 
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       FontWeight="SemiBold" Margin="12,0,0,0"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- Issues List -->
                    <StackPanel x:Name="IssuesPanel" Visibility="Collapsed">
                        <TextBlock Text="ISSUES FOUND" Style="{StaticResource SettingsSectionStyle}" Margin="0,0,0,8"/>
                        
                        <ItemsControl x:Name="IssuesList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#10FFFFFF" CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Path Data="M1,21h22L12,2L1,21z M13,18h-2v-2h2V18z M13,14h-2v-4h2V14z"
                                                  Width="16" Height="16" Stretch="Uniform"
                                                  Fill="#F44336" VerticalAlignment="Top" Margin="0,2,0,0"/>
                                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                                <TextBlock Text="{Binding RelativePath}" 
                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                           TextWrapping="Wrap"/>
                                                <TextBlock Text="{Binding Description}" 
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           FontSize="11" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- Missing Files -->
                        <ItemsControl x:Name="MissingFilesList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#10FFFFFF" CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Path Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12z"
                                                  Width="16" Height="16" Stretch="Uniform"
                                                  Fill="#FF9800" VerticalAlignment="Center"/>
                                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                                <TextBlock Text="{Binding}" 
                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                           TextWrapping="Wrap"/>
                                                <TextBlock Text="File missing from disk" 
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           FontSize="11"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>

            <!-- ========== FOOTER ========== -->
            <Border Grid.Row="2" Background="{StaticResource BackgroundMediumBrush}" 
                    CornerRadius="0,0,12,12" Padding="24,16">
                <Button Content="Close" 
                        Style="{StaticResource PrimaryButtonStyle}"
                        Padding="32,10"
                        HorizontalAlignment="Right"
                        Click="CloseButton_Click"/>
            </Border>
        </Grid>
    </Border>
</Window>
