<Window x:Class="Swarm.UI.SettingsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings" 
        Height="600" Width="500"
        MinHeight="500" MinWidth="400"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    
    <Border Background="{StaticResource BackgroundDarkBrush}" 
            CornerRadius="12" 
            BorderBrush="#30FFFFFF" 
            BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="48"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- ========== TITLE BAR ========== -->
            <Border Grid.Row="0" Background="{StaticResource BackgroundMediumBrush}" 
                    CornerRadius="12,12,0,0" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="16,0">
                        <!-- Settings Icon -->
                        <Path Data="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"
                              Width="20" Height="20" 
                              Stretch="Uniform"
                              Fill="{StaticResource AccentPrimaryBrush}"
                              VerticalAlignment="Center"/>
                        <TextBlock Text="Settings" FontWeight="Bold" FontSize="16" 
                                   Foreground="{StaticResource TextPrimaryBrush}" 
                                   VerticalAlignment="Center" Margin="12,0,0,0"/>
                    </StackPanel>

                    <!-- Close Button -->
                    <Button Content="✕" Width="40" Height="32" 
                            HorizontalAlignment="Right" Margin="0,0,8,0"
                            Foreground="#F85149"
                            Background="Transparent" BorderThickness="0"
                            Padding="0" Cursor="Hand"
                            Click="CloseButton_Click"/>
                </Grid>
            </Border>

            <!-- ========== SETTINGS CONTENT ========== -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="24,0">
                <StackPanel Margin="0,0,0,24">
                    
                    <!-- ===== GENERAL SECTION ===== -->
                    <TextBlock Text="GENERAL" Style="{StaticResource SettingsSectionStyle}" Margin="0,16,0,12"/>
                    
                    <!-- Device Name -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="Device Name" Style="{StaticResource SettingsLabelStyle}"/>
                        <TextBlock Text="How this device appears to others on the network" 
                                   Style="{StaticResource SettingsDescriptionStyle}"/>
                        <TextBox x:Name="DeviceNameTextBox" 
                                 Style="{StaticResource SettingsTextBoxStyle}"
                                 Margin="0,8,0,0"/>
                    </StackPanel>
                    
                    <!-- Start Minimized -->
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Start Minimized" Style="{StaticResource SettingsLabelStyle}"/>
                            <TextBlock Text="Start the app minimized to system tray" 
                                       Style="{StaticResource SettingsDescriptionStyle}"/>
                        </StackPanel>
                        <CheckBox x:Name="StartMinimizedToggle" Grid.Column="1" 
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  VerticalAlignment="Center"/>
                    </Grid>
                    
                    <!-- ===== TRANSFERS SECTION ===== -->
                    <TextBlock Text="TRANSFERS" Style="{StaticResource SettingsSectionStyle}"/>
                    
                    <!-- Notifications Enabled -->
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Show Notifications" Style="{StaticResource SettingsLabelStyle}"/>
                            <TextBlock Text="Show dialogs for incoming files and other alerts" 
                                       Style="{StaticResource SettingsDescriptionStyle}"/>
                        </StackPanel>
                        <CheckBox x:Name="NotificationsToggle" Grid.Column="1" 
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  VerticalAlignment="Center"/>
                    </Grid>
                    
                    <!-- Download Location -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="Download Location" Style="{StaticResource SettingsLabelStyle}"/>
                        <TextBlock Text="Where received files are saved" 
                                   Style="{StaticResource SettingsDescriptionStyle}"/>
                        <Grid Margin="0,8,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Background="#10FFFFFF" CornerRadius="8" Padding="12,8">
                                <TextBlock x:Name="DownloadPathText" 
                                           Text="Downloads\Swarm" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextTrimming="CharacterEllipsis"
                                           VerticalAlignment="Center"/>
                            </Border>
                            <Button Grid.Column="1" Content="Browse" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="12,8" Margin="8,0,0,0"
                                    Click="BrowseDownloadPath_Click"/>
                        </Grid>
                    </StackPanel>
                    
                    <!-- Auto Accept from Trusted -->
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Auto-Accept from Trusted" Style="{StaticResource SettingsLabelStyle}"/>
                            <TextBlock Text="Automatically accept files from trusted peers" 
                                       Style="{StaticResource SettingsDescriptionStyle}"/>
                        </StackPanel>
                        <CheckBox x:Name="AutoAcceptToggle" Grid.Column="1" 
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  VerticalAlignment="Center"/>
                    </Grid>
                    
                    <!-- Show Transfer Complete -->
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Show Completion Message" Style="{StaticResource SettingsLabelStyle}"/>
                            <TextBlock Text="Show a message when file transfer completes" 
                                       Style="{StaticResource SettingsDescriptionStyle}"/>
                        </StackPanel>
                        <CheckBox x:Name="ShowCompleteToggle" Grid.Column="1" 
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  VerticalAlignment="Center"/>
                    </Grid>
                    
                    <!-- ===== SYNC SECTION ===== -->
                    <TextBlock Text="SYNC" Style="{StaticResource SettingsSectionStyle}"/>
                    
                    <!-- Sync Enabled -->
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Enable Folder Sync" Style="{StaticResource SettingsLabelStyle}"/>
                            <TextBlock Text="Automatically sync files with connected peers" 
                                       Style="{StaticResource SettingsDescriptionStyle}"/>
                        </StackPanel>
                        <CheckBox x:Name="SyncEnabledToggle" Grid.Column="1" 
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  VerticalAlignment="Center"/>
                    </Grid>
                    
                    <!-- Sync Folder Location -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="Sync Folder Location" Style="{StaticResource SettingsLabelStyle}"/>
                        <TextBlock Text="Files in this folder are synced across devices" 
                                   Style="{StaticResource SettingsDescriptionStyle}"/>
                        <Grid Margin="0,8,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Background="#10FFFFFF" CornerRadius="8" Padding="12,8">
                                <TextBlock x:Name="SyncFolderPathText" 
                                           Text="Documents\SWARM\Synced" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextTrimming="CharacterEllipsis"
                                           VerticalAlignment="Center"/>
                            </Border>
                            <Button Grid.Column="1" Content="Browse" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="12,8" Margin="8,0,0,0"
                                    Click="BrowseSyncFolder_Click"/>
                        </Grid>
                    </StackPanel>
                    
                    <!-- ===== TRUSTED PEERS SECTION ===== -->
                    <TextBlock Text="TRUSTED PEERS" Style="{StaticResource SettingsSectionStyle}"/>
                    
                    <TextBlock Text="Peers you trust for automatic file acceptance" 
                               Style="{StaticResource SettingsDescriptionStyle}" Margin="0,0,0,8"/>
                    
                    <Border Background="#10FFFFFF" CornerRadius="8" Padding="12" MinHeight="60">
                        <Grid>
                            <ListBox x:Name="TrustedPeersListBox" 
                                     Background="Transparent" 
                                     BorderThickness="0"
                                     ItemContainerStyle="{StaticResource PeerListBoxItemStyle}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{Binding Name}" 
                                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                                <TextBlock Text="{Binding Id}" 
                                                           FontSize="11"
                                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                                            </StackPanel>
                                            <Button Grid.Column="1" Content="✕" 
                                                    Foreground="#F85149"
                                                    Background="Transparent" 
                                                    BorderThickness="0"
                                                    Padding="8,4" Cursor="Hand"
                                                    Click="RemoveTrustedPeer_Click"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            
                            <TextBlock x:Name="NoTrustedPeersText" 
                                       Text="No trusted peers configured" 
                                       Foreground="{StaticResource TextMutedBrush}"
                                       FontSize="13"
                                       VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Grid>
                    </Border>
                    
                    <!-- ===== ABOUT SECTION ===== -->
                    <TextBlock Text="ABOUT" Style="{StaticResource SettingsSectionStyle}"/>
                    
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Swarm" FontWeight="SemiBold" FontSize="16"
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                            <TextBlock x:Name="VersionText" Text=" v1.0.0" FontSize="16"
                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                        </StackPanel>
                        <TextBlock Text="Fast, secure LAN file sharing and sync" 
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   FontSize="12" Margin="0,4,0,0"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>

            <!-- ========== FOOTER BUTTONS ========== -->
            <Border Grid.Row="2" Background="{StaticResource BackgroundMediumBrush}" 
                    CornerRadius="0,0,12,12" Padding="24,16">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Cancel" 
                            Style="{StaticResource SecondaryButtonStyle}"
                            Padding="24,10"
                            Click="CancelButton_Click"/>
                    <Button Content="Save Changes" 
                            Style="{StaticResource PrimaryButtonStyle}"
                            Padding="24,10" Margin="12,0,0,0"
                            Click="SaveButton_Click"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
