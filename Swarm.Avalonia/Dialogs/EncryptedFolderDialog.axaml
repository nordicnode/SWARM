<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="450" d:DesignHeight="500"
        x:Class="Swarm.Avalonia.Dialogs.EncryptedFolderDialog"
        Title="Encrypted Folder"
        Width="450" 
        MinHeight="400"
        SizeToContent="Height"
        CanResize="False"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource BackgroundDarkBrush}"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="NoChrome"
        SystemDecorations="BorderOnly">

    <Window.Styles>
        <Style Selector="TextBox">
            <Setter Property="Background" Value="#1a1a1a"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderLightBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
        <Style Selector="TextBox:focus /template/ Border#PART_BorderElement">
            <Setter Property="BorderBrush" Value="{StaticResource AccentPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </Window.Styles>

    <Border CornerRadius="8" ClipToBounds="True" BorderBrush="{StaticResource BorderLightBrush}" BorderThickness="1">
        <Grid RowDefinitions="Auto,*,Auto">
            
            <!-- Standard Header -->
            <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}" Padding="16,12">
                <Grid ColumnDefinitions="Auto,*,Auto">
                    <!-- Icon -->
                    <PathIcon Grid.Column="0" 
                              Data="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"
                              Width="20" Height="20"
                              Foreground="{StaticResource AccentPrimaryBrush}"
                              VerticalAlignment="Center"
                              Margin="0,0,12,0"/>
                    
                    <!-- Title -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock x:Name="TitleText" 
                                   Text="Create Encrypted Folder" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                        <TextBlock x:Name="SubtitleText"
                                   Text="AES-256 Encryption"
                                   FontSize="12"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,2,0,0"/>
                    </StackPanel>
                    
                    <!-- Close Button -->
                    <Button Grid.Column="2" 
                            Click="CloseButton_Click"
                            Classes="icon"
                            ToolTip.Tip="Close">
                        <PathIcon Data="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                                  Width="14" Height="14"
                                  Foreground="{StaticResource TextSecondaryBrush}"/>
                    </Button>
                </Grid>
            </Border>

            <!-- Content -->
            <ScrollViewer Grid.Row="1" 
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled">
                <StackPanel Margin="24" Spacing="20">
                    
                    <!-- Folder Name Field (Create mode only) -->
                    <StackPanel x:Name="FolderNamePanel" Spacing="8">
                        <TextBlock Text="Folder Name"
                                   FontSize="13"
                                   FontWeight="Medium"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBox x:Name="FolderNameInput"
                                 Watermark="e.g. Private Documents"/>
                    </StackPanel>

                    <!-- Password Field -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Password"
                                   FontSize="13"
                                   FontWeight="Medium"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBox x:Name="PasswordInput"
                                 PasswordChar="•"
                                 Watermark="Minimum 8 characters"/>
                    </StackPanel>

                    <!-- Confirm Password Field (Create mode only) -->
                    <StackPanel x:Name="ConfirmPasswordPanel" Spacing="8">
                        <TextBlock Text="Confirm Password"
                                   FontSize="13"
                                   FontWeight="Medium"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBox x:Name="ConfirmPasswordInput"
                                 PasswordChar="•"
                                 Watermark="Re-enter password"/>
                    </StackPanel>

                    <!-- Error Message -->
                    <Border x:Name="ErrorPanel"
                            Background="#33FF5555"
                            BorderBrush="{StaticResource ErrorBrush}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="12"
                            IsVisible="False">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"
                                      Width="16" Height="16"
                                      Foreground="{StaticResource ErrorBrush}"
                                      VerticalAlignment="Center"/>
                            <TextBlock x:Name="ErrorText"
                                       Foreground="{StaticResource ErrorBrush}"
                                       FontSize="13"
                                       TextWrapping="Wrap"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- Security Warning (Create mode only) -->
                    <Border x:Name="WarningPanel"
                            Background="#33FFAA00"
                            BorderBrush="#FFAA00"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="12">
                        <Grid ColumnDefinitions="Auto,*">
                            <PathIcon Grid.Column="0" 
                                      Data="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"
                                      Width="18" Height="18"
                                      Foreground="#FFAA00"
                                      VerticalAlignment="Top"
                                      Margin="0,2,12,0"/>
                            <StackPanel Grid.Column="1" Spacing="2">
                                <TextBlock Text="Important"
                                           FontWeight="SemiBold"
                                           Foreground="#FFAA00"
                                           FontSize="13"/>
                                <TextBlock Text="If you forget this password, your files cannot be recovered. There is no password reset."
                                           Foreground="#FFAA00"
                                           FontSize="12"
                                           TextWrapping="Wrap"
                                           Opacity="0.9"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                </StackPanel>
            </ScrollViewer>

            <!-- Footer -->
            <Border Grid.Row="2" 
                    Background="{StaticResource SurfaceBrush}"
                    Padding="16"
                    BorderBrush="{StaticResource BorderLightBrush}"
                    BorderThickness="0,1,0,0">
                <Grid ColumnDefinitions="*,Auto,Auto">
                    <Button Grid.Column="1"
                            Content="Cancel"
                            Click="CloseButton_Click"
                            Classes="secondary"
                            Margin="0,0,12,0"/>
                    <Button x:Name="ActionButton"
                            Grid.Column="2" 
                            Content="Create Folder"
                            Click="ActionButton_Click"
                            Classes="primary"/>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
